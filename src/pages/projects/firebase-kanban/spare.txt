<div>
  {epics &&
    epics.length > 0 &&
    itemsGroupedByEpic &&
    Object.keys(itemsGroupedByEpic).length > 0 &&
    epics.map(({ title: epicKey, id: epicID }) => {
      // Get ref to epic and set up delete handler
      const epicDocRef = doc(firebase.firestore(), "epics", epicID);
      const handleDelete = async () => {
        try {
          await deleteDoc(epicDocRef);
        } catch (err) {
          alert(err);
        }
      };
      // Parse and sort tasks by status
      const itemsInEpic = itemsGroupedByEpic[epicKey];
      const itemsInEpicGroupedByStatus = groupBy(itemsInEpic, "status");
      return (
        <Box
          customisation={{
            marginY: "spacing6",
            backgroundColor: "neutral_bg_2",
            borderColor: "neutral_ui_2",
            border: "1px solid",
            padding: "spacing3",
            borderRadius: "sm",
          }}
        >
          <Box
            customisation={{
              display: "flex",
              justifyContent: "space-between",
              marginBottom: "spacing3",
            }}
          >
            {/* ——————————————————————————————————————————————
                    //      EPIC BOARD TITLE & CONTROLS
                    //      Here we add the epic title, delete epic button, and create new task button
                    // —————————————————————————————————————————————— */}
            <Typography
              customisation={{
                fontWeight: "semibold",
                color: "accent_fg_2",
                marginBottom: "spacing1",
              }}
            >
              {epicKey}
            </Typography>
            {/* Epic buttons wrapper */}
            <Box
              customisation={{
                display: "flex",
                marginBottom: "spacing1",
              }}
            >
              <CreateNewTaskDialog
                statusesDropdownItems={statusesDropdownItems}
                epicsDropdownItems={epicsDropdownItems}
              />
              <Button
                iconTrailing="times"
                variant={{ size: "md", appearance: "tertiary" }}
                title="Delete this epic"
                // width="100%"
                onClick={handleDelete}
              />
            </Box>
          </Box>
          {/* ——————————————————————————————————————————————————————————————————————————————
                    //      MAP OVER STATUSES
                    // ——————————————————————————————————————————————————————————————————————————————  */}
          {/* Status column layout */}
          <Box
            customisation={{
              display: "grid",
              gridTemplateColumns: {
                mobile: "1x",
                tablet: "3x",
                desktop: "3x",
              },
              gap: "spacing3",
            }}
          >
            {statusesSortedBySortIndex &&
              statusesSortedBySortIndex.length > 0 &&
              statusesSortedBySortIndex.map(({ title: statusKey }) => {
                return (
                  <Box>
                    <Typography
                      customisation={{
                        fontSize: "body_lg",
                        textTransform: "uppercase",
                        fontWeight: "semibold",
                        color: "neutral_fg_1",
                        marginBottom: "spacing3",
                      }}
                    >
                      {statusKey}
                    </Typography>
                    {/* —————————————————————————————————————————————
                              //      MAP OVER ITEMS WITHIN STATUS
                              // —————————————————————————————————————————————— */}
                    {itemsInEpicGroupedByStatus[statusKey] &&
                      itemsInEpicGroupedByStatus[statusKey].length > 0 &&
                      itemsInEpicGroupedByStatus[statusKey].map((item) => {
                        return (
                          <KanbanListItem
                            id={item.id}
                            key={item.id}
                            title={item.title}
                            status={item.status}
                            epic={item.epic}
                            statusesDropdownItems={statusesDropdownItems}
                            epicsDropdownItems={epicsDropdownItems}
                          />
                        );
                      })}
                  </Box>
                );
              })}
          </Box>
        </Box>
      );
    })}
</div>;
